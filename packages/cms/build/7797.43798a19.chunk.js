"use strict";(self.webpackChunk_contentweaver_cms=self.webpackChunk_contentweaver_cms||[]).push([[7797],{13635:(x,D,s)=>{s.d(D,{u:()=>h});var t=s(2730),g=s(43348),R=s(96508),i=s(91155);const h=(L={},m)=>{const{locale:A}=(0,R.A)(),O=(0,g.QM)(A,{sensitivity:"base"}),{data:d,error:c,isError:v,isLoading:C,refetch:I}=(0,i.z)(L,m);return{roles:t.useMemo(()=>[...d??[]].sort((B,W)=>O.compare(B.name,W.name)),[d,O]),error:c,isError:v,isLoading:C,refetch:I}}},17797:(x,D,s)=>{s.d(D,{ProtectedSSO:()=>F});var t=s(58466),g=s(16113),R=s(38973),i=s(12688),h=s(64469),L=s(61680),m=s(18834),A=s(15659),O=s(59979),d=s(60216),c=s(13321),v=s(10010),C=s(30215),I=s(13775),a=s(43348),B=s(81100),W=s(85209),y=s(96508),r=s(69093),M=s(91155),j=s(13635),q=s(79412),ss=s(9361),ts=s(95052),os=s(50682),as=s(20153),_s=s(76024),ns=s(2730),ls=s(34511),es=s(43900),Es=s(85041),is=s(3891),ds=s(90588),rs=s(49382),Ms=s(12762),Os=s(19292),Ps=s(9174),Ds=s(6056),gs=s(33854),Rs=s(31075),hs=s(19727),Ls=s(8184),ms=s(11001),As=s(15778),cs=s(81806),vs=s(95431),Cs=s(55688),Is=s(32962),Bs=s(40060),Ws=s(26208),Ks=s(31666),Ts=s(69506),fs=s(3691),Us=s(2119),us=s(46705),xs=s(59362),ys=s(98907),js=s(28685),Ss=s(45946),ps=s(6377),Fs=s(71484),zs=s(97755),Ns=s(85960),Vs=s(25395),Xs=s(35771);const S=r.Ik().shape({autoRegister:r.lc().required(a.iW.required),defaultRole:r.gl().when("autoRegister",(o,_)=>o?_.required(a.iW.required):_.nullable()),ssoLockedRoles:r.YO().nullable().of(r.gl().when("ssoLockedRoles",(o,_)=>o?_.required(a.iW.required):_.nullable()))}),p=()=>{(0,a.L4)();const{formatMessage:o}=(0,y.A)(),_=(0,M.j)(e=>e.admin_app.permissions),{lockApp:z,unlockApp:N}=(0,a.MA)(),K=(0,a.hN)(),{_unstableFormatAPIError:V,_unstableFormatValidationErrors:X}=(0,a.wq)(),{isLoading:Q,data:Y}=(0,M.W)(),[$,{isLoading:G}]=(0,M.X)(),{isLoading:H,allowedActions:{canUpdate:T,canReadRoles:J}}=(0,a.ec)({..._.settings?.sso,readRoles:_.settings?.roles.read??[]}),{roles:U,isLoading:Z}=(0,j.u)(void 0,{skip:!J}),k=async(e,P)=>{z();try{const n=await $(e);if("error"in n){(0,M.x)(n.error)&&n.error.name==="ValidationError"?P.setErrors(X(n.error)):K({type:"warning",message:V(n.error)});return}K({type:"success",message:{id:"notification.success.saved"}})}catch{K({type:"warning",message:{id:"notification.error",defaultMessage:"An error occurred, please try again."}})}finally{N()}},u=Z||H||Q;return(0,t.jsxs)(h.P,{children:[(0,t.jsx)(a.x7,{name:"SSO"}),(0,t.jsx)(A.g,{"aria-busy":G||u,tabIndex:-1,children:(0,t.jsx)(W.l1,{onSubmit:k,initialValues:Y||{autoRegister:!1,defaultRole:null,ssoLockedRoles:null},validationSchema:S,validateOnChange:!1,enableReinitialize:!0,children:({handleChange:e,isSubmitting:P,values:n,setFieldValue:b,dirty:w,errors:E})=>(0,t.jsxs)(a.lV,{children:[(0,t.jsx)(m.Q,{primaryAction:(0,t.jsx)(g.$,{disabled:!w,loading:P,startIcon:(0,t.jsx)(B.A,{}),type:"submit",size:"L",children:o({id:"global.save",defaultMessage:"Save"})}),title:o({id:"Settings.sso.title",defaultMessage:"Single Sign-On"}),subtitle:o({id:"Settings.sso.description",defaultMessage:"Configure the settings for the Single Sign-On feature."})}),(0,t.jsx)(L.s,{children:P||u?(0,t.jsx)(a.Bl,{}):(0,t.jsxs)(O.s,{direction:"column",alignItems:"stretch",gap:4,background:"neutral0",padding:6,shadow:"filterShadow",hasRadius:!0,children:[(0,t.jsx)(I.o,{variant:"delta",as:"h2",children:o({id:"global.settings",defaultMessage:"Settings"})}),(0,t.jsxs)(R.x,{gap:4,children:[(0,t.jsx)(i.E,{col:6,s:12,children:(0,t.jsx)(C.l,{disabled:!T,checked:n.autoRegister,hint:o({id:"Settings.sso.form.registration.description",defaultMessage:"Create new user on SSO login if no account exists"}),label:o({id:"Settings.sso.form.registration.label",defaultMessage:"Auto-registration"}),name:"autoRegister",offLabel:o({id:"app.components.ToggleCheckbox.off-label",defaultMessage:"Off"}),onLabel:o({id:"app.components.ToggleCheckbox.on-label",defaultMessage:"On"}),onChange:e})}),(0,t.jsx)(i.E,{col:6,s:12,children:(0,t.jsx)(c.l,{disabled:!T,hint:o({id:"Settings.sso.form.defaultRole.description",defaultMessage:"It will attach the new authenticated user to the selected role"}),error:E.defaultRole?o({id:E.defaultRole,defaultMessage:E.defaultRole}):"",label:o({id:"Settings.sso.form.defaultRole.label",defaultMessage:"Default role"}),name:"defaultRole",onChange:l=>e({target:{name:"defaultRole",value:l}}),placeholder:o({id:"components.InputSelect.option.placeholder",defaultMessage:"Choose here"}),value:n.defaultRole,children:U.map(({id:l,name:f})=>(0,t.jsx)(v.c,{value:l.toString(),children:f},l))})}),(0,t.jsx)(i.E,{col:6,s:12,children:(0,t.jsx)(d.KF,{disabled:!T,hint:o({id:"Settings.sso.form.localAuthenticationLock.description",defaultMessage:"Select the roles for which you want to disable the local authentication"}),error:E.ssoLockedRoles?o({id:E.ssoLockedRoles,defaultMessage:E.ssoLockedRoles}):"",label:o({id:"Settings.sso.form.localAuthenticationLock.label",defaultMessage:"Local authentication lock-out"}),name:"ssoLockedRoles",onChange:l=>e({target:{value:l,name:"ssoLockedRoles"}}),placeholder:o({id:"components.InputSelect.option.placeholder",defaultMessage:"Choose here"}),onClear:()=>b("ssoLockedRoles",[]),value:n.ssoLockedRoles||[],withTags:!0,children:U.map(({id:l,name:f})=>(0,t.jsx)(d.fe,{value:l.toString(),children:f},l))})})]})]})})]})})})]})},F=()=>{const o=(0,M.j)(_=>_.admin_app.permissions.settings?.sso?.main);return(0,t.jsx)(a.kz,{permissions:o,children:(0,t.jsx)(p,{})})}}}]);

"use strict";(self.webpackChunk_MokoshAI_cms=self.webpackChunk_MokoshAI_cms||[]).push([[9588],{13635:(N,g,s)=>{s.d(g,{u:()=>i});var a=s(2730),e=s(43348),E=s(96508),P=s(91155);const i=(c={},f)=>{const{locale:C}=(0,E.A)(),D=(0,e.QM)(C,{sensitivity:"base"}),{data:O,error:A,isError:U,isLoading:t,refetch:B}=(0,P.z)(c,f);return{roles:a.useMemo(()=>[...O??[]].sort((T,r)=>D.compare(T.name,r.name)),[O,D]),error:A,isError:U,isLoading:t,refetch:B}}},13760:(N,g,s)=>{s.d(g,{M:()=>U,S:()=>t,a:()=>A});var a=s(58466),e=s(96508),E=s(91155),P=s(7479),i=s(60216),c=s(43348),f=s(92659),C=s(94837),D=s(86784),O=s(13635);const A=({children:r,target:_})=>{const d=(0,c.hN)(),{formatMessage:I}=(0,e.A)(),{copy:h}=(0,c.iD)(),l=I({id:"app.component.CopyToClipboard.label",defaultMessage:"Copy to clipboard"}),n=async()=>{await h(_)&&d({type:"info",message:{id:"notification.link-copied"}})};return(0,a.jsx)(c.bQ,{endAction:(0,a.jsx)(P.K,{label:l,noBorder:!0,icon:(0,a.jsx)(f.A,{}),onClick:n}),title:_,titleEllipsis:!0,subtitle:r,icon:(0,a.jsx)("span",{style:{fontSize:32},children:"\u2709\uFE0F"}),iconBackground:"neutral100"})},U=({registrationToken:r})=>{const{formatMessage:_}=(0,e.A)(),d=`${window.location.origin}${(0,E.K)()}/auth/register?registrationToken=${r}`;return(0,a.jsx)(A,{target:d,children:_({id:"app.components.Users.MagicLink.connect",defaultMessage:"Copy and share this link to give access to this user"})})},t=({disabled:r,error:_,onChange:d,value:I})=>{const{isLoading:h,roles:l}=(0,O.u)(),{formatMessage:n}=(0,e.A)(),p=_?n({id:_,defaultMessage:_}):"",F=n({id:"app.components.Users.ModalCreateBody.block-title.roles",defaultMessage:"User's roles"}),Z=n({id:"app.components.Users.ModalCreateBody.block-title.roles.description",defaultMessage:"A user can have one or several roles"}),J=n({id:"app.components.Select.placeholder",defaultMessage:"Select"});return(0,a.jsx)(i.KF,{id:"roles",disabled:r,error:p,hint:Z,label:F,name:"roles",onChange:M=>{d({target:{name:"roles",value:M}})},placeholder:J,startIcon:h?(0,a.jsx)(T,{}):void 0,value:I.map(M=>M.toString()),withTags:!0,required:!0,children:l.map(M=>(0,a.jsx)(i.fe,{value:M.id.toString(),children:n({id:`global.${M.code}`,defaultMessage:M.name})},M.id))})},B=(0,D.i7)`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(359deg);
  }
`,R=D.Ay.div`
  animation: ${B} 2s infinite linear;
`,T=()=>(0,a.jsx)(R,{children:(0,a.jsx)(C.A,{})})},83764:(N,g,s)=>{s.d(g,{C:()=>E});var a=s(43348),e=s(69093);const E={firstname:e.Yj().trim().required(a.iW.required),lastname:e.Yj(),email:e.Yj().email(a.iW.email).lowercase().required(a.iW.required),username:e.Yj().nullable(),password:e.Yj().min(8,a.iW.minLength).matches(/[a-z]/,"components.Input.error.contain.lowercase").matches(/[A-Z]/,"components.Input.error.contain.uppercase").matches(/\d/,"components.Input.error.contain.number"),confirmPassword:e.Yj().min(8,a.iW.minLength).oneOf([e.KR("password"),null],"components.Input.error.password.noMatch").when("password",(P,i)=>P?i.required(a.iW.required):i)}},99588:(N,g,s)=>{s.d(g,{ProtectedEditPage:()=>ts});var a=s(58466),e=s(2730),E=s(45227),P=s(16113),i=s(38973),c=s(12688),f=s(61680),C=s(18834),D=s(15659),O=s(59979),A=s(13775),U=s(20128),t=s(43348),B=s(63440),R=s(81100),T=s(85209),r=s(20153),_=s(96508),d=s(77645),I=s(37299),h=s(69093),l=s(91155),n=s(89142),p=s(13760),F=s(83764),Z=s(79412),J=s(9361),M=s(95052),ds=s(50682),ls=s(76024),Es=s(34511),Ms=s(43900),ms=s(85041),Ps=s(3891),cs=s(90588),Ds=s(49382),Os=s(12762),gs=s(19292),As=s(9174),hs=s(6056),vs=s(33854),Ls=s(31075),fs=s(19727),Cs=s(8184),Us=s(11001),Bs=s(15778),Is=s(81806),us=s(95431),Ws=s(55688),Rs=s(32962),Ts=s(40060),ps=s(26208),Ks=s(31666),xs=s(69506),js=s(3691),ys=s(2119),Ss=s(46705),zs=s(59362),Ns=s(98907),Fs=s(28685),Ys=s(45946),Vs=s(6377),$s=s(71484),Qs=s(97755),Xs=s(85960),Hs=s(25395),Gs=s(35771),Zs=s(50885),Js=s(66451),ws=s(13635);const q=h.Ik().shape({...F.C,isActive:h.lc(),roles:h.YO().min(1,t.iW.required).required(t.iW.required)}),w=["email","firstname","lastname","username","isActive","roles"],ss=()=>{const{formatMessage:o}=(0,_.A)(),u=(0,d.W5)("/settings/users/:id")?.params?.id??"",{push:W}=(0,d.W6)(),m=(0,t.hN)(),{lockApp:V,unlockApp:$}=(0,t.MA)(),b=(0,l.p)(p.M,async()=>(await s.e(7853).then(s.bind(s,27853))).MagicLinkEE),{_unstableFormatAPIError:Q,_unstableFormatValidationErrors:es}=(0,t.wq)(),k=(0,l.j)(n.s),{isLoading:os,allowedActions:{canUpdate:X}}=(0,t.ec)({read:k.settings?.users.read??[],update:k.settings?.users.update??[]}),[ns]=(0,l.M)();(0,t.L4)();const{data:is,error:y,isLoading:rs}=(0,l.k)({id:u},{refetchOnMountOrArgChange:!0}),[S]=is?.users??[];if(e.useEffect(()=>{y&&(y.name==="UnauthorizedError"?(m({type:"info",message:{id:"notification.permission.not-allowed-read",defaultMessage:"You are not allowed to see this document"}}),W("/")):m({type:"warning",message:{id:"notification.error",defaultMessage:Q(y)}}))},[y,Q,W,m]),rs||!b||os)return(0,a.jsxs)(D.g,{"aria-busy":"true",children:[(0,a.jsx)(t.x7,{name:"Users"}),(0,a.jsx)(C.Q,{primaryAction:(0,a.jsx)(P.$,{disabled:!0,startIcon:(0,a.jsx)(R.A,{}),type:"button",size:"L",children:o({id:"global.save",defaultMessage:"Save"})}),title:o({id:"app.containers.Users.EditPage.header.label-loading",defaultMessage:"Edit user"}),navigationAction:(0,a.jsx)(U.N,{as:I.k2,startIcon:(0,a.jsx)(B.A,{}),to:"/settings/users?pageSize=10&page=1&sort=firstname",children:o({id:"global.back",defaultMessage:"Back"})})}),(0,a.jsx)(f.s,{children:(0,a.jsx)(t.Bl,{})})]});const z={...r(S,w),roles:S.roles.map(({id:v})=>v),password:"",confirmPassword:""},_s=async(v,K)=>{V?.();const{confirmPassword:H,password:x,...G}=v,L=await ns({id:u,...G,password:x===""?void 0:x});"error"in L&&(0,l.x)(L.error)?(L.error.name==="ValidationError"&&K.setErrors(es(L.error)),m({type:"warning",message:Q(L.error)})):(m({type:"success",message:o({id:"notification.success.saved",defaultMessage:"Saved"})}),K.setValues({...r(v,w),password:"",confirmPassword:""})),$?.()};return(0,a.jsxs)(D.g,{children:[(0,a.jsx)(t.x7,{name:"Users"}),(0,a.jsx)(T.l1,{onSubmit:_s,initialValues:z,validateOnChange:!1,validationSchema:q,children:({errors:v,values:K,handleChange:H,isSubmitting:x,dirty:G})=>(0,a.jsxs)(t.lV,{children:[(0,a.jsx)(C.Q,{primaryAction:(0,a.jsx)(P.$,{disabled:x||!X?!0:!G,startIcon:(0,a.jsx)(R.A,{}),loading:x,type:"submit",size:"L",children:o({id:"global.save",defaultMessage:"Save"})}),title:o({id:"app.containers.Users.EditPage.header.label",defaultMessage:"Edit {name}"},{name:z.username||(0,n.g)(z?.firstname??"",z.lastname)}),navigationAction:(0,a.jsx)(U.N,{as:I.k2,startIcon:(0,a.jsx)(B.A,{}),to:"/settings/users?pageSize=10&page=1&sort=firstname",children:o({id:"global.back",defaultMessage:"Back"})})}),(0,a.jsxs)(f.s,{children:[S?.registrationToken&&(0,a.jsx)(E.a,{paddingBottom:6,children:(0,a.jsx)(b,{registrationToken:S.registrationToken})}),(0,a.jsxs)(O.s,{direction:"column",alignItems:"stretch",gap:7,children:[(0,a.jsx)(E.a,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7,children:(0,a.jsxs)(O.s,{direction:"column",alignItems:"stretch",gap:4,children:[(0,a.jsx)(A.o,{variant:"delta",as:"h2",children:o({id:"app.components.Users.ModalCreateBody.block-title.details",defaultMessage:"Details"})}),(0,a.jsx)(i.x,{gap:5,children:as.map(L=>L.map(j=>(0,a.jsx)(c.E,{...j.size,children:(0,a.jsx)(t.ah,{...j,disabled:!X,error:v[j.name],onChange:H,value:K[j.name]})},j.name)))})]})}),(0,a.jsx)(E.a,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7,children:(0,a.jsxs)(O.s,{direction:"column",alignItems:"stretch",gap:4,children:[(0,a.jsx)(A.o,{variant:"delta",as:"h2",children:o({id:"global.roles",defaultMessage:"User's role"})}),(0,a.jsx)(i.x,{gap:5,children:(0,a.jsx)(c.E,{col:6,xs:12,children:(0,a.jsx)(p.S,{disabled:!X,error:v.roles,onChange:H,value:K.roles})})})]})})]})]})]})})]})},as=[[{intlLabel:{id:"Auth.form.firstname.label",defaultMessage:"First name"},name:"firstname",placeholder:{id:"Auth.form.firstname.placeholder",defaultMessage:"e.g. Kai"},type:"text",size:{col:6,xs:12},required:!0},{intlLabel:{id:"Auth.form.lastname.label",defaultMessage:"Last name"},name:"lastname",placeholder:{id:"Auth.form.lastname.placeholder",defaultMessage:"e.g. Doe"},type:"text",size:{col:6,xs:12}}],[{intlLabel:{id:"Auth.form.email.label",defaultMessage:"Email"},name:"email",placeholder:{id:"Auth.form.email.placeholder",defaultMessage:"e.g. kai.doe@strapi.io"},type:"email",size:{col:6,xs:12},required:!0},{intlLabel:{id:"Auth.form.username.label",defaultMessage:"Username"},name:"username",placeholder:{id:"Auth.form.username.placeholder",defaultMessage:"e.g. Kai_Doe"},type:"text",size:{col:6,xs:12}}],[{intlLabel:{id:"global.password",defaultMessage:"Password"},name:"password",type:"password",size:{col:6,xs:12},autoComplete:"new-password"},{intlLabel:{id:"Auth.form.confirmPassword.label",defaultMessage:"Password confirmation"},name:"confirmPassword",type:"password",size:{col:6,xs:12},autoComplete:"new-password"}],[{intlLabel:{id:"Auth.form.active.label",defaultMessage:"Active"},name:"isActive",type:"bool",size:{col:6,xs:12}}]],ts=()=>{const o=(0,t.hN)(),Y=(0,l.j)(n.s),{isLoading:u,allowedActions:{canRead:W,canUpdate:m}}=(0,t.ec)({read:Y.settings?.users.read??[],update:Y.settings?.users.update??[]}),{state:V}=(0,d.zy)(),$=V?.from??"/";return e.useEffect(()=>{u||!W&&!m&&o({type:"info",message:{id:"notification.permission.not-allowed-read",defaultMessage:"You are not allowed to see this document"}})},[u,W,m,o]),u?(0,a.jsx)(t.Bl,{}):!W&&!m?(0,a.jsx)(d.rd,{to:$}):(0,a.jsx)(ss,{})}}}]);

"use strict";(self.webpackChunk_contentweaver_cms=self.webpackChunk_contentweaver_cms||[]).push([[8911],{13635:(N,P,s)=>{s.d(P,{u:()=>T});var _=s(2730),e=s(43348),D=s(96508),C=s(91155);const T=(h={},A)=>{const{locale:R}=(0,D.A)(),M=(0,e.QM)(R,{sensitivity:"base"}),{data:a,error:L,isError:m,isLoading:K,refetch:v}=(0,C.z)(h,A);return{roles:_.useMemo(()=>[...a??[]].sort((x,i)=>M.compare(x.name,i.name)),[a,M]),error:L,isError:m,isLoading:K,refetch:v}}},31458:(N,P,s)=>{s.d(P,{S:()=>M});var _=s(58466),e=s(86784),D=s(45227),C=s(86507),T=s(59979),h=s(13775);const A=(0,e.Ay)(D.a)`
  height: ${24/16}rem;
  width: ${24/16}rem;
  border-radius: 50%;
  display: flex;
  justify-content: center;
  align-items: center;

  svg {
    height: ${10/16}rem;
    width: ${10/16}rem;
  }

  svg path {
    fill: ${({theme:a})=>a.colors.primary600};
  }
`,R=(0,e.Ay)(D.a)`
  border-radius: 0 0 ${({theme:a})=>a.borderRadius} ${({theme:a})=>a.borderRadius};
  display: block;
  width: 100%;
  border: none;
`,M=({children:a,icon:L,...m})=>(0,_.jsxs)("div",{children:[(0,_.jsx)(C.c,{}),(0,_.jsx)(R,{as:"button",background:"primary100",padding:5,...m,children:(0,_.jsxs)(T.s,{children:[(0,_.jsx)(A,{"aria-hidden":!0,background:"primary200",children:L}),(0,_.jsx)(D.a,{paddingLeft:3,children:(0,_.jsx)(h.o,{variant:"pi",fontWeight:"bold",textColor:"primary600",children:a})})]})})]})},48911:(N,P,s)=>{s.d(P,{ProtectedListPage:()=>ts});var _=s(58466),e=s(2730),D=s(45227),C=s(16113),T=s(7479),h=s(28535),A=s(61680),R=s(18834),M=s(15659),a=s(59979),L=s(60783),m=s(46067),K=s(48065),v=s(94323),l=s(71869),x=s(31458),i=s(13775),G=s(9891),n=s(43348),Q=s(92659),H=s(76263),S=s(53176),J=s(30018),Y=s(71646),Z=s(94683),$=s(96508),b=s(77645),F=s(91155),k=s(13635),z=s(89142),Ms=s(79412),rs=s(9361),Os=s(95052),Ps=s(50682),Cs=s(20153),Ts=s(76024),hs=s(34511),As=s(85209),Rs=s(43900),Ls=s(69093),ms=s(85041),gs=s(3891),vs=s(90588),Bs=s(49382),cs=s(12762),Ws=s(19292),Is=s(9174),Us=s(6056),Ks=s(33854),xs=s(31075),js=s(19727),fs=s(8184),ys=s(11001),us=s(15778),ps=s(81806),Ns=s(95431),Ss=s(55688),$s=s(32962),Fs=s(40060),zs=s(26208),Vs=s(31666),Xs=s(69506),Gs=s(3691),Qs=s(2119),Hs=s(46705),Js=s(59362),Ys=s(98907),Zs=s(28685),bs=s(45946),ks=s(6377),ws=s(71484),qs=s(97755),s_=s(85960),__=s(25395),t_=s(35771),o_=s(50885),n_=s(66451);const w=({id:t,name:O,description:E,usersCount:B,icons:c,rowIndex:j,canUpdate:W})=>{const{formatMessage:I}=(0,$.A)(),[,g]=c,f=I({id:"Roles.RoleRow.user-count",defaultMessage:"{number, plural, =0 {#  user} one {#  user} other {# users}}"},{number:B});return(0,_.jsxs)(v.Tr,{"aria-rowindex":j,...W?(0,n.qM)({fn:g.onClick}):{},children:[(0,_.jsx)(l.Td,{maxWidth:(0,n.a8)(130),children:(0,_.jsx)(i.o,{ellipsis:!0,textColor:"neutral800",children:O})}),(0,_.jsx)(l.Td,{maxWidth:(0,n.a8)(250),children:(0,_.jsx)(i.o,{ellipsis:!0,textColor:"neutral800",children:E})}),(0,_.jsx)(l.Td,{children:(0,_.jsx)(i.o,{textColor:"neutral800",children:f})}),(0,_.jsx)(l.Td,{children:(0,_.jsx)(a.s,{justifyContent:"flex-end",...n.dG,children:c.map((d,U)=>d?(0,_.jsx)(D.a,{paddingLeft:U===0?0:1,children:(0,_.jsx)(T.K,{onClick:d.onClick,label:d.label,borderWidth:0,icon:d.icon})},d.label):null)})})]},t)},q=()=>{const{formatMessage:t}=(0,$.A)();(0,n.L4)();const O=(0,F.j)(z.s),{formatAPIError:E}=(0,n.wq)(),B=(0,n.hN)(),[c,j]=e.useState(!1),[{query:W}]=(0,n.sq)(),{isLoading:I,allowedActions:{canCreate:g,canDelete:f,canRead:d,canUpdate:U}}=(0,n.ec)(O.settings?.roles),{roles:V,refetch:os}=(0,k.u)({filters:W?._q?{name:{$containsi:W._q}}:void 0},{refetchOnMountOrArgChange:!0,skip:I||!d}),{push:y}=(0,b.W6)(),[{showModalConfirmButtonLoading:ns,roleToDelete:as},u]=e.useReducer(_s,ss),{post:Es}=(0,n.GD)(),ls=async()=>{try{u({type:"ON_REMOVE_ROLES"}),await Es("/admin/roles/batch-delete",{ids:[as]}),await os(),u({type:"RESET_DATA_TO_DELETE"})}catch(o){o instanceof Y.pe&&B({type:"warning",message:E(o)})}p()},X=()=>y("/settings/roles/new"),p=()=>j(o=>!o),ds=o=>r=>{r.preventDefault(),r.stopPropagation(),o.usersCount?B({type:"info",message:{id:"Roles.ListPage.notification.delete-not-allowed"}}):(u({type:"SET_ROLE_TO_DELETE",id:o.id}),p())},is=o=>r=>{r.preventDefault(),r.stopPropagation(),y(`/settings/roles/duplicate/${o.id}`)},es=V.length+1,Ds=6;return I?(0,_.jsx)(M.g,{children:(0,_.jsx)(n.Bl,{})}):(0,_.jsxs)(M.g,{children:[(0,_.jsx)(n.x7,{name:"Roles"}),(0,_.jsx)(R.Q,{primaryAction:g?(0,_.jsx)(C.$,{onClick:X,startIcon:(0,_.jsx)(S.A,{}),size:"S",children:t({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"})}):null,title:t({id:"global.roles",defaultMessage:"roles"}),subtitle:t({id:"Settings.roles.list.description",defaultMessage:"List of roles"}),as:"h2"}),d&&(0,_.jsx)(h.B,{startActions:(0,_.jsx)(n.q7,{label:t({id:"app.component.search.label",defaultMessage:"Search for {target}"},{target:t({id:"global.roles",defaultMessage:"roles"})})})}),d&&(0,_.jsx)(A.s,{children:(0,_.jsxs)(L.X,{colCount:Ds,rowCount:es,footer:g?(0,_.jsx)(x.S,{onClick:X,icon:(0,_.jsx)(S.A,{}),children:t({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"})}):null,children:[(0,_.jsx)(K.d,{children:(0,_.jsxs)(v.Tr,{"aria-rowindex":1,children:[(0,_.jsx)(l.Th,{children:(0,_.jsx)(i.o,{variant:"sigma",textColor:"neutral600",children:t({id:"global.name",defaultMessage:"Name"})})}),(0,_.jsx)(l.Th,{children:(0,_.jsx)(i.o,{variant:"sigma",textColor:"neutral600",children:t({id:"global.description",defaultMessage:"Description"})})}),(0,_.jsx)(l.Th,{children:(0,_.jsx)(i.o,{variant:"sigma",textColor:"neutral600",children:t({id:"global.users",defaultMessage:"Users"})})}),(0,_.jsx)(l.Th,{children:(0,_.jsx)(G.s,{children:t({id:"global.actions",defaultMessage:"Actions"})})})]})}),(0,_.jsx)(m.N,{children:V?.map((o,r)=>(0,_.jsx)(w,{id:o.id,name:o.name,description:o.description,usersCount:o.usersCount,icons:[g&&{onClick:is(o),label:t({id:"app.utils.duplicate",defaultMessage:"Duplicate"}),icon:(0,_.jsx)(Q.A,{})},U&&{onClick:()=>y(`/settings/roles/${o.id}`),label:t({id:"app.utils.edit",defaultMessage:"Edit"}),icon:(0,_.jsx)(H.A,{})},f&&{onClick:ds(o),label:t({id:"global.delete",defaultMessage:"Delete"}),icon:(0,_.jsx)(J.A,{})}].filter(Boolean),rowIndex:r+2,canUpdate:U},o.id))})]})}),(0,_.jsx)(n.TM,{isOpen:c,onConfirm:ls,isConfirmButtonLoading:ns,onToggleDialog:p})]})},ss={roleToDelete:null,showModalConfirmButtonLoading:!1,shouldRefetchData:!1},_s=(t,O)=>(0,Z.Ay)(t,E=>{switch(O.type){case"ON_REMOVE_ROLES":{E.showModalConfirmButtonLoading=!0;break}case"ON_REMOVE_ROLES_SUCCEEDED":{E.shouldRefetchData=!0,E.roleToDelete=null;break}case"RESET_DATA_TO_DELETE":{E.shouldRefetchData=!1,E.roleToDelete=null,E.showModalConfirmButtonLoading=!1;break}case"SET_ROLE_TO_DELETE":{E.roleToDelete=O.id;break}default:return E}}),ts=()=>{const t=(0,F.j)(z.s);return(0,_.jsx)(n.kz,{permissions:t.settings?.roles.main,children:(0,_.jsx)(q,{})})}}}]);

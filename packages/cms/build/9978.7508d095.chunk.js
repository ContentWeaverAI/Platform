"use strict";(self.webpackChunk_MokoshAI_cms=self.webpackChunk_MokoshAI_cms||[]).push([[9978],{29978:(ss,I,s)=>{s.d(I,{ProtectedCreatePage:()=>H});var t=s(58466),W=s(2730),d=s(45227),h=s(16113),c=s(38973),g=s(12688),T=s(61680),U=s(18834),K=s(15659),M=s(59979),f=s(88663),j=s(50389),A=s(13775),x=s(20128),r=s(43348),y=s(63440),u=s(16737),p=s(85209),S=s(96508),C=s(77645),$=s(37299),N=s(86784),O=s(69093),n=s(91155),F=s(86962),ts=s(79412),as=s(9361),_s=s(95052),os=s(50682),rs=s(20153),ns=s(76024),Es=s(34511),is=s(43900),ds=s(85041),es=s(3891),ls=s(90588),Ms=s(49382),Ps=s(12762),Ds=s(19292),Os=s(9174),ms=s(6056),hs=s(33854),gs=s(31075),As=s(19727),Cs=s(8184),Rs=s(11001),vs=s(15778),Bs=s(81806),Ls=s(95431),Is=s(55688),Ws=s(32962),cs=s(40060),Ts=s(26208),Us=s(31666),Ks=s(69506),fs=s(3691),js=s(2119),xs=s(46705),ys=s(59362),us=s(98907),ps=s(28685),Ss=s(45946),$s=s(6377),Ns=s(71484),Fs=s(97755),zs=s(85960),Vs=s(25395),Ys=s(35771),Hs=s(3330),Qs=s(27488);const z=O.Ik().shape({name:O.Yj().required(r.iW.required),description:O.Yj().required(r.iW.required)}),V=()=>{const a=(0,C.W5)("/settings/roles/duplicate/:id"),e=(0,r.hN)(),{lockApp:Q,unlockApp:X}=(0,r.MA)(),{formatMessage:_}=(0,S.A)(),{replace:G}=(0,C.W6)(),m=W.useRef(null),{trackUsage:R}=(0,r.z1)(),{_unstableFormatAPIError:v,_unstableFormatValidationErrors:B}=(0,r.wq)(),P=a?.params.id??null,{isLoading:J,data:L}=(0,n.A)({role:P??""}),{data:Z,isLoading:w}=(0,n.B)({id:P},{skip:!P,refetchOnMountOrArgChange:!0}),[b]=(0,n.D)(),[k]=(0,n.E)(),q=async(D,E)=>{try{Q(),R(P?"willDuplicateRole":"willCreateNewRole");const o=await b(D);if("error"in o){(0,n.x)(o.error)&&o.error.name==="ValidationError"?E.setErrors(B(o.error)):e({type:"warning",message:v(o.error)});return}const{permissionsToSend:l}=m.current?.getPermissions()??{};if(o.data.id&&Array.isArray(l)&&l.length>0){const i=await k({id:o.data.id,permissions:l});if("error"in i){(0,n.x)(i.error)&&i.error.name==="ValidationError"?E.setErrors(B(i.error)):e({type:"warning",message:v(i.error)});return}}e({type:"success",message:{id:"Settings.roles.created",defaultMessage:"created"}}),G(`/settings/roles/${o.data.id}`)}catch{e({type:"warning",message:{id:"notification.error"}})}finally{X()}};return(0,t.jsxs)(K.g,{children:[(0,t.jsx)(r.x7,{name:"Roles"}),(0,t.jsx)(p.l1,{initialValues:{name:"",description:`${_({id:"Settings.roles.form.created",defaultMessage:"Created"})} ${(0,u.A)(new Date,"PPP")}`},onSubmit:q,validationSchema:z,validateOnChange:!1,children:({values:D,errors:E,handleReset:o,handleChange:l,isSubmitting:i})=>(0,t.jsx)(r.lV,{children:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(U.Q,{primaryAction:(0,t.jsxs)(M.s,{gap:2,children:[(0,t.jsx)(h.$,{variant:"secondary",onClick:()=>{o(),m.current?.resetForm()},size:"L",children:_({id:"app.components.Button.reset",defaultMessage:"Reset"})}),(0,t.jsx)(h.$,{type:"submit",loading:i,size:"L",children:_({id:"global.save",defaultMessage:"Save"})})]}),title:_({id:"Settings.roles.create.title",defaultMessage:"Create a role"}),subtitle:_({id:"Settings.roles.create.description",defaultMessage:"Define the rights given to the role"}),navigationAction:(0,t.jsx)(x.N,{as:$.k2,startIcon:(0,t.jsx)(y.A,{}),to:"/settings/roles",children:_({id:"global.back",defaultMessage:"Back"})})}),(0,t.jsx)(T.s,{children:(0,t.jsxs)(M.s,{direction:"column",alignItems:"stretch",gap:6,children:[(0,t.jsx)(d.a,{background:"neutral0",padding:6,shadow:"filterShadow",hasRadius:!0,children:(0,t.jsxs)(M.s,{direction:"column",alignItems:"stretch",gap:4,children:[(0,t.jsxs)(M.s,{justifyContent:"space-between",children:[(0,t.jsxs)(d.a,{children:[(0,t.jsx)(d.a,{children:(0,t.jsx)(A.o,{fontWeight:"bold",children:_({id:"global.details",defaultMessage:"Details"})})}),(0,t.jsx)(d.a,{children:(0,t.jsx)(A.o,{variant:"pi",textColor:"neutral600",children:_({id:"Settings.roles.form.description",defaultMessage:"Name and description of the role"})})})]}),(0,t.jsx)(Y,{children:_({id:"Settings.roles.form.button.users-with-role",defaultMessage:"{number, plural, =0 {# users} one {# user} other {# users}} with this role"},{number:0})})]}),(0,t.jsxs)(c.x,{gap:4,children:[(0,t.jsx)(g.E,{col:6,children:(0,t.jsx)(f.k,{name:"name",error:E.name&&_({id:E.name}),label:_({id:"global.name",defaultMessage:"Name"}),onChange:l,required:!0,value:D.name})}),(0,t.jsx)(g.E,{col:6,children:(0,t.jsx)(j.T,{label:_({id:"global.description",defaultMessage:"Description"}),id:"description",error:E.description&&_({id:E.description}),onChange:l,children:D.description})})]})]})}),!J&&!w&&L?(0,t.jsx)(d.a,{shadow:"filterShadow",hasRadius:!0,children:(0,t.jsx)(F.P,{isFormDisabled:!1,ref:m,permissions:Z,layout:L})}):(0,t.jsx)(d.a,{background:"neutral0",padding:6,shadow:"filterShadow",hasRadius:!0,children:(0,t.jsx)(r.Bl,{})})]})})]})})})]})},Y=N.Ay.div`
  border: 1px solid ${({theme:a})=>a.colors.primary200};
  background: ${({theme:a})=>a.colors.primary100};
  padding: ${({theme:a})=>`${a.spaces[2]} ${a.spaces[4]}`};
  color: ${({theme:a})=>a.colors.primary600};
  border-radius: ${({theme:a})=>a.borderRadius};
  font-size: ${12/16}rem;
  font-weight: bold;
`,H=()=>{const a=(0,n.j)(e=>e.admin_app.permissions.settings?.roles.create);return(0,t.jsx)(r.kz,{permissions:a,children:(0,t.jsx)(V,{})})}}}]);
